
# Бот доступу та модерації для поліції UKRAINE GTA

Бот на python-telegram-bot (async) з анкетою доступу, модерацією «неактиву», оформленням доган, антиспамом і повним логуванням у SQLite.

## Швидкий старт

1) Встановіть залежності (Python 3.10+):

```bash
pip install -r requirements.txt
```

2) Створіть файл оточення `.env` (див. приклад `.env.example`) і задайте ключові змінні:

- BOT_TOKEN — токен Telegram бота
- ADMIN_IDS — список ID адмінів через кому (наприклад: 111,222)
- REPORTS_CHAT_ID — ID групи для публікацій/форумних тем (число зі знаком -100...)
- GROUP_CHAT_ID — ID основної групи (для інвайтів)
- WARNINGS_TOPIC_ID — ID теми для доган
- AFK_TOPIC_ID — ID теми для неактиву
- DB_PATH або DB_DIR — шлях до SQLite (за замовчуванням ./data/bot.db)

3) Запуск:

```bash
python bot.py
```

## Можливості

- Анкета доступу з перевіркою імені українською, вибором підрозділу і звання, перевіркою URL скринів
- Модерація заяв на «неактив» у приваті адмінам з публікацією у форумній темі з атрибуцією
- Оформлення доган із красивими картками і збереженням в БД
- Антиспам для повідомлень і callback-ів
- База даних SQLite: профілі, зображення, заяви, рішення, логи дій/оновлень/антиспаму
- Адмін-утиліти: /me, /user, /find, /broadcast_fill, /admin

## Налаштування змінних оточення

У Railway/Render або локально через `.env`:

- BOT_TOKEN
- ADMIN_IDS
- REPORTS_CHAT_ID, GROUP_CHAT_ID
- WARNINGS_TOPIC_ID, AFK_TOPIC_ID
- DB_PATH або DB_DIR

## Безпека

- Не комітьте токени та приватні дані. Використовуйте `.env` і `.gitignore` (див. додачу).
- Перевіряйте права бота у групах і форумах (можливість постити у теми, створювати інвайти).

## Примітки по БД

Файл БД за замовчуванням: `./data/bot.db`. Таблиці: `profiles`, `profile_images`, `warnings`, `neaktyv_requests`, `access_applications`, `action_logs`, `profile_updates`, `antispam_events`.

Міграції виконуються автоматично при старті через `init_db()`.

## Тестовий запуск

Є спрощений сценарій `test_local.py` для локальних перевірок логіки без справжніх інвайтів. Токен беріть з оточення.

